<div class="tour-management-container">
  <!-- هدر صفحه -->
  <div class="header-section">
    <h1 class="page-title">
      <i class="bi bi-geo-alt-fill"></i>
      مدیریت تورها
    </h1>
    <div class="action-buttons">
      <button class="btn btn-outline">
        <i class="bi bi-filter"></i>
        فیلترها
      </button>
      <button (click)="OpenInsertForm()" type="button" class="btn btn-primary">
        <i class="bi bi-plus-circle"></i>
        افزودن تور جدید
      </button>
    </div>
  </div>

  <!-- بخش فیلترها -->
  <div class="filter-section">
    <div class="filter-group">
      <label class="filter-label">جستجو</label>
      <input [(ngModel)]="TourNameFilter" type="text" class="filter-input" placeholder="نام تور یا مقصد...">
    </div>
    <div class="row">
      <div class="col-md-6">
        <app-base-select-nice
          [items]="TourTypeCombo"
          label="نوع تور"
          bindLabel="Name"
          bindValue="Guid"
          placeholder="نوع تور"
          [(ngModel)]="TourTypeGuidFilter"
          (change)="tourTypeFilterChange($event)">
        </app-base-select-nice>
      </div>
      <div class="col-md-6">
        <app-base-select-nice
          [items]="TourTypeCombo"
          label="نوع تور"
          bindLabel="Name"
          bindValue="Guid"
          placeholder="نوع تور"
          [(ngModel)]="TourTypeGuidFilter"
          (change)="tourTypeFilterChange($event)">
        </app-base-select-nice>
      </div>
    </div>

    <div class="filter-group d-flex gap-2">
      <button (click)="SearchWithFilters()" class="btn btn-primary" style="height: 45px;">
        اعمال فیلترها
      </button>

      <button (click)="ClearFilters()" class="btn btn-danger" style="height: 45px;">
        حذف فیلترها
      </button>
    </div>
  </div>


  <!-- کارت‌های آمار -->
  <div class="stats-cards">
    <div class="stat-card">
      <div class="stat-icon icon-primary">
        <i class="bi bi-house-door"></i>
      </div>
      <div class="stat-info">
        <h3>۴۲</h3>
        <p>چادرگردانی</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon icon-success">
        <i class="bi bi-water"></i>
      </div>
      <div class="stat-info">
        <h3>۲۸</h3>
        <p>کایاک سواری</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon icon-warning">
        <i class="bi bi-bicycle"></i>
      </div>
      <div class="stat-info">
        <h3>۳۵</h3>
        <p>دوچرخه سواری</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon icon-danger">
        <i class="bi bi-fish"></i>
      </div>
      <div class="stat-info">
        <h3>۱۹</h3>
        <p>ماهیگیری</p>
      </div>
    </div>
  </div>

  <!-- جدول تورها -->
  <div class="tours-table-container">
    <div class="table-header">
      <h3 class="table-title">لیست تورها</h3>
      <div class="search-box">
        <input type="text" class="search-input" placeholder="جستجوی تور...">
        <i class="bi bi-search search-icon"></i>
      </div>
    </div>

    @if (!!BindPagingError) {
      <div class="row text-center">
        <span>{{ BindPagingError }}</span>
      </div>
    } @else {
      <div class="table-responsive">
        <table class="tours-table">
          <thead>
          <tr>
            <th>ردیف</th>
            <th>نام تور</th>
            <th>نوع</th>
            <th>مبدا</th>
            <th>حمل و نقل</th>
            <th>مقصد</th>
            <th>قیمت</th>
            <th>وضعیت</th>
            <th>عملیات</th>
          </tr>
          </thead>
          <tbody>
            @for (tour of TourList; track $index) {
              <tr>
                <td>{{ ((BasePaginationFilter.PageSize * (BasePaginationFilter.PageNumber - 1)) + $index + 1) | persianNumber }}</td>
                <td>{{ tour.Title }}</td>
                <td>{{ tour.TourTypeName }}</td>
                <td>{{ tour.OriginName }}</td>
                <td>{{ tour.TransportTypeName }}</td>
                <td>{{ tour.DestinationName }}</td>
                <td>{{ tour.Price | persianNumber:true }}</td>
                <td><span class="status-badge status-active">فعال</span></td>
                <td>
                  <div class="action-buttons">
                    <button class="action-btn btn-view"><i class="bi bi-eye"></i></button>
                    <button (click)="OpenEditForm(tour)" class="action-btn btn-edit"><i class="bi bi-pencil"></i>
                    </button>
                    <button class="action-btn btn-delete"><i class="bi bi-trash"></i></button>
                  </div>
                </td>
              </tr>

            }
          </tbody>
        </table>
      </div>
    }


    <!-- صفحه‌بندی -->
    <app-management-paging
      [pageNumber]="BasePaginationFilter.PageNumber"
      [pageSize]="BasePaginationFilter.PageSize"
      [totalCount]="TourListBaseResponse?.DataCount || 0"
      [maxPagesToShow]="2"
      (pageChange)="onPageChange($event)">
    </app-management-paging>
  </div>
</div>
